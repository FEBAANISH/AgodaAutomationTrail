package TestPackage;

import org.testng.Assert;
import org.testng.annotations.AfterMethod;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.BeforeMethod;
import org.testng.annotations.BeforeTest;
import org.testng.annotations.Test;

import ExtendedReport.extendTestReport;
import Listerners.RetryAnalyzer;
import Pages.CreateAccountPage;

import io.qameta.allure.Description;
import io.qameta.allure.Severity;
import io.qameta.allure.SeverityLevel;
import io.qameta.allure.Story;

public class createAccountTest extends BaseTest {

	private CreateAccountPage createAccountPage;
	private extendTestReport report;

	@BeforeMethod
	public void NavigateToCreateAccountPage() {

		report = new extendTestReport(driver);
		report.initializeReport();

	}

	@Test(retryAnalyzer = RetryAnalyzer.class)
	public void SwitchToFrame() {

		createAccountPage = bp.getInstance(CreateAccountPage.class);
		createAccountPage.waitForCreateButton();
		createAccountPage.create_Account_Button_Click();
		createAccountPage.waitForFrame();
		String assertFrameTitle = createAccountPage.validateFrameTitle();
		try {
			log.info("verifying Title");
			Assert.assertEquals(assertFrameTitle, "Sign up", "Frame title does not match!");
			report.logTestWithScreenshot("Switch to frame", true);

		} catch (AssertionError e) {
			report.logTestWithScreenshot("Frame Not found", false);
			throw e;

		}

	}

	@AfterMethod
	public void reportFlush() {
		report.flushReport();
	}

}
