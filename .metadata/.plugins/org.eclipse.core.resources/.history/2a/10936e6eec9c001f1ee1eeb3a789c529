package ExtendedReport;

import java.lang.module.ModuleDescriptor.Exports;

import org.openqa.selenium.WebDriver;
import screenshotPackage.Screenshot_Util;
import com.aventstack.extentreports.ExtentReports;
import com.aventstack.extentreports.ExtentTest;
import com.aventstack.extentreports.reporter.ExtentSparkReporter;
import com.aventstack.extentreports.reporter.configuration.Theme;

public class extendTestReport {
	
	public static ExtentSparkReporter sparkreport;
	public static ExtentTest test;
	public static ExtentReports extent;
	private WebDriver driver;
	private Screenshot_Util screenshotUtil;
	
	public extendTestReport(WebDriver driver)
	{
		this.driver =driver;
		this.screenshotUtil = new Screenshot_Util(driver);
	}
	public void initializeReport()
	{
		 sparkreport = new ExtentSparkReporter(System.getProperty("user.dir") + "\\src\\main\\resources\\Report\\SparkReport.html");
		 sparkreport.config().setDocumentTitle("Automation Report");
		 sparkreport.config().setReportName("Agoda Automation Test Result");
		 sparkreport.config().setTheme(Theme.STANDARD);
		 sparkreport.config().setTimeStampFormat("EEEE, MMMM dd, yyyy hh:mm a zzz");
		 extent = new ExtentReports();
		 extent.attachReporter(sparkreport);
	}
	private String takeScreenshot(String testName) {
        // Use the Screenshot_Util class to capture screenshot
        screenshotUtil.takePageScreenshot(); // Or use screenshotUtil.takeElementScreenshot()
        // Return the path of the saved screenshot
        return System.getProperty("user.dir") + "\\Screenshot\\" + testName + ".png";
    }
	public void logTestWithScreenshot(String testName, boolean isTestPassed)
	{
		test = extent.createTest(testName);
		if (isTestPassed) {
            test.pass("Test Passed");
        } else {
            test.fail("Test Failed");
            // Take screenshot and attach it to the report
            String screenshotPath = takeScreenshot(testName); // Capture screenshot
            test.addScreenCaptureFromPath(screenshotPath); // Attach screenshot to the report
        }
	}

}
